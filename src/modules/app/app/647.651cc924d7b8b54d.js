"use strict";(self.webpackChunkwordlift_plugin_app=self.webpackChunkwordlift_plugin_app||[]).push([[647],{8647:(R,x,a)=>{a.r(x),a.d(x,{SuperResolutionDialogsModule:()=>d});var g=a(6895),o=a(8176),O=a(5698),C=a(8505),Z=a(4351),A=a(6451),S=a(4004),U=a(9300),n=a(4650),N=a(4311),f=a(3910),z=a(6616),D=a(7044),P=a(1664),h=a(5681);class c{transform(e){return`${(e/1024).toLocaleString("en-US",{maximumFractionDigits:0})}KB`}}function v(i,e){if(1&i&&(n.TgZ(0,"img-comparison-slider",6)(1,"figure",7),n._UZ(2,"img",8),n.TgZ(3,"figcaption"),n._uU(4,"Before"),n.qZA()(),n.TgZ(5,"figure",9),n._UZ(6,"img",8),n.TgZ(7,"figcaption"),n._uU(8,"After"),n.qZA()(),n.O4$(),n.TgZ(9,"svg",10),n._UZ(10,"path",11),n.qZA()()),2&i){const t=n.oxw(2);n.xp6(2),n.Q6J("src",t.originalImage.data,n.LSH),n.xp6(4),n.Q6J("src",t.upscaledImage.data,n.LSH)}}function T(i,e){if(1&i&&(n.TgZ(0,"div",3)(1,"nz-spin",4),n.YNc(2,v,11,2,"img-comparison-slider",5),n.qZA()()),2&i){const t=n.oxw();n.xp6(1),n.Q6J("nzSpinning",t.loading),n.xp6(1),n.Q6J("ngIf",!t.loading)}}function y(i,e){if(1&i){const t=n.EpF();n.TgZ(0,"div",12)(1,"div",13)(2,"dl")(3,"dt"),n._uU(4,"Original File Size"),n.qZA(),n.TgZ(5,"dd",14),n._uU(6),n.ALo(7,"bytesToKilobytes"),n.qZA()(),n.TgZ(8,"dl")(9,"dt"),n._uU(10,"Upscaled File Size"),n.qZA(),n.TgZ(11,"dd",15),n._uU(12),n.ALo(13,"bytesToKilobytes"),n.qZA()()(),n.TgZ(14,"div")(15,"button",16),n.NdJ("click",function(){n.CHM(t);const l=n.oxw();return n.KtG(l.handleCancel())}),n._uU(16," Cancel "),n.qZA(),n.TgZ(17,"button",17),n.NdJ("click",function(){n.CHM(t);const l=n.oxw();return n.KtG(l.handleApply())}),n._uU(18,"Apply"),n.qZA()()()}if(2&i){const t=n.oxw();n.xp6(6),n.lnq(" ",t.originalImage.width,"*",t.originalImage.height,"px (",n.lcZ(7,6,t.originalImage.size),") "),n.xp6(6),n.lnq(" ",t.upscaledImage.width,"*",t.upscaledImage.height,"px (",n.lcZ(13,8,t.upscaledImage.size),") ")}}c.\u0275fac=function(e){return new(e||c)},c.\u0275pipe=n.Yjl({name:"bytesToKilobytes",type:c,pure:!0});const L=function(){return{marginTop:"-21px",marginBottom:"-27px"}};class u{constructor(e,t){this.route=e,this.superResolutionService=t,this.undefined=void 0,this.loading=!0,this.attachmentId=0,this.originalImage=new M,this.upscaledImage=new M}ngOnInit(){this.route.paramMap.pipe((0,O.q)(1),(0,S.U)(e=>e.get("postId")),(0,U.h)(e=>null!==e),(0,S.U)(e=>parseInt(e)),(0,C.b)(e=>this.attachmentId=e),(0,Z.b)(e=>this.images(e))).subscribe({complete:()=>this.loading=!1,error:e=>{console.error(e)}})}images(e){return(0,A.T)(this.loadImage(this.superResolutionService.getAttachmentImage({attachmentId:e}),this.originalImage),this.loadImage(this.superResolutionService.getAttachmentImageUpscale({attachmentId:e}),this.upscaledImage))}loadImage(e,t){return e.pipe((0,C.b)(s=>{const r=`data:image/jpeg;base64,${function j(i){for(var e="",t=new Uint8Array(i),s=t.byteLength,l=0;l<s;l++)e+=String.fromCharCode(t[l]);return window.btoa(e)}(s)}`,m=new Image;m.onload=()=>{t.data=r,t.width=m.width,t.height=m.height,t.size=s.byteLength,URL.revokeObjectURL(r)},m.src=r}))}handleCancel(){}handleApply(){0!==this.attachmentId&&this.superResolutionService.replaceAttachmentImage({attachmentId:this.attachmentId,body:{image:B(this.upscaledImage.data.split(",")[1],"image/jpeg")}}).subscribe({error:e=>console.log(e)})}}u.\u0275fac=function(e){return new(e||u)(n.Y36(o.gz),n.Y36(N.X))},u.\u0275cmp=n.Xpm({type:u,selectors:[["wlx-super-resolution-upscale"]],decls:3,vars:4,consts:[["nzOkText","Delete","nzOkDanger","true","nzCancelText","Cancel","nzTitle","WordLift Image Upscale",3,"nzVisible","nzWidth","nzBodyStyle"],["class","modal-content",4,"nzModalContent"],["class","modal-footer",4,"nzModalFooter"],[1,"modal-content"],["nzSize","large",1,"nz-spin-fix",3,"nzSpinning"],["tabindex","0","class","rendered",4,"ngIf"],["tabindex","0",1,"rendered"],["slot","first",1,"before"],["height","550",3,"src"],["slot","second",1,"after"],["slot","handle","xmlns","http://www.w3.org/2000/svg","width","60","viewBox","-8 -3 16 6"],["stroke","#fff","d","M -5 -2 L -7 0 L -5 2 M -5 -2 L -5 2 M 5 -2 L 7 0 L 5 2 M 5 -2 L 5 2","stroke-width","1","fill","#fff","vector-effect","non-scaling-stroke"],[1,"modal-footer"],[1,"metadata"],[1,"original"],[1,"upscaled"],["nz-button","","nzType","default",3,"click"],["nz-button","","nzType","primary",3,"click"]],template:function(e,t){1&e&&(n.TgZ(0,"nz-modal",0),n.YNc(1,T,3,2,"div",1),n.YNc(2,y,19,10,"div",2),n.qZA()),2&e&&n.Q6J("nzVisible",!0)("nzWidth",825)("nzBodyStyle",n.DdM(3,L))},dependencies:[g.O5,f.du,f.Uh,f.Hf,z.ix,D.w,P.dQ,h.W,c],styles:["img-comparison-slider[_ngcontent-%COMP%]{--divider-width: 2px;--default-handle-opacity: .3;outline:0}.modal-content[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;height:550px;max-height:550px}.modal-footer[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;height:55px;padding:0 8px}.metadata[_ngcontent-%COMP%]{display:flex;flex:1;gap:40px;text-align:left;font-size:14px;align-items:center;justify-items:center}.metadata[_ngcontent-%COMP%]   dl[_ngcontent-%COMP%]{margin-bottom:0}.metadata[_ngcontent-%COMP%]   dt[_ngcontent-%COMP%]{font-weight:300}.metadata[_ngcontent-%COMP%]   .original[_ngcontent-%COMP%]{color:#ff4d4f}.metadata[_ngcontent-%COMP%]   .upscaled[_ngcontent-%COMP%]{color:#00c48c}.before[_ngcontent-%COMP%], .after[_ngcontent-%COMP%]{margin:0}.before[_ngcontent-%COMP%]   figcaption[_ngcontent-%COMP%], .after[_ngcontent-%COMP%]   figcaption[_ngcontent-%COMP%]{border-radius:15px;height:30px;line-height:22px;padding:4px 12px;background:rgba(0,0,0,.4);border:0;text-transform:uppercase;color:#fff;font-size:9pt;bottom:24px;position:absolute}.before[_ngcontent-%COMP%]   figcaption[_ngcontent-%COMP%]{left:24px}.after[_ngcontent-%COMP%]   figcaption[_ngcontent-%COMP%]{right:24px}"]});class M{constructor(){this.data="",this.width=0,this.height=0,this.size=0}}function B(i,e){const t=atob(i),s=new Array(t.length);for(let r=0;r<t.length;r++)s[r]=t.charCodeAt(r);const l=new Uint8Array(s);return new Blob([l],{type:e})}const F=[{path:":postId/upscale",component:u}];class p{}p.\u0275fac=function(e){return new(e||p)},p.\u0275mod=n.oAB({type:p}),p.\u0275inj=n.cJS({imports:[o.Bz.forChild(F),o.Bz]});var b=a(4586),$=a(8800);class d{}d.\u0275fac=function(e){return new(e||d)},d.\u0275mod=n.oAB({type:d}),d.\u0275inj=n.cJS({imports:[g.ez,p,f.Qp,z.sL,b.D,h.j,$.ZJ]})},5681:(R,x,a)=>{a.d(x,{W:()=>$,j:()=>d});var g=a(655),o=a(4650),O=a(7579),C=a(1135),Z=a(4707),A=a(5963),S=a(8675),U=a(1884),n=a(3900),N=a(4482),f=a(5032),z=a(5403),D=a(8421),h=a(2722),c=a(2536),v=a(3187),T=a(445),y=a(6895),L=a(9643);function u(i,e){1&i&&(o.TgZ(0,"span",3),o._UZ(1,"i",4)(2,"i",4)(3,"i",4)(4,"i",4),o.qZA())}function M(i,e){}function j(i,e){if(1&i&&(o.TgZ(0,"div",8),o._uU(1),o.qZA()),2&i){const t=o.oxw(2);o.xp6(1),o.Oqu(t.nzTip)}}function B(i,e){if(1&i&&(o.TgZ(0,"div")(1,"div",5),o.YNc(2,M,0,0,"ng-template",6),o.YNc(3,j,2,1,"div",7),o.qZA()()),2&i){const t=o.oxw(),s=o.MAs(1);o.xp6(1),o.ekj("ant-spin-rtl","rtl"===t.dir)("ant-spin-spinning",t.isLoading)("ant-spin-lg","large"===t.nzSize)("ant-spin-sm","small"===t.nzSize)("ant-spin-show-text",t.nzTip),o.xp6(1),o.Q6J("ngTemplateOutlet",t.nzIndicator||s),o.xp6(1),o.Q6J("ngIf",t.nzTip)}}function F(i,e){if(1&i&&(o.TgZ(0,"div",9),o.Hsn(1),o.qZA()),2&i){const t=o.oxw();o.ekj("ant-spin-blur",t.isLoading)}}const p=["*"],b="spin";let $=(()=>{class i{constructor(t,s,l){this.nzConfigService=t,this.cdr=s,this.directionality=l,this._nzModuleName=b,this.nzIndicator=null,this.nzSize="default",this.nzTip=null,this.nzDelay=0,this.nzSimple=!1,this.nzSpinning=!0,this.destroy$=new O.x,this.spinning$=new C.X(this.nzSpinning),this.delay$=new Z.t(1),this.isLoading=!1,this.dir="ltr"}ngOnInit(){this.delay$.pipe((0,S.O)(this.nzDelay),(0,U.x)(),(0,n.w)(s=>0===s?this.spinning$:this.spinning$.pipe(function P(i){return(0,N.e)((e,t)=>{let s=!1,l=null,r=null;const m=()=>{if(r?.unsubscribe(),r=null,s){s=!1;const I=l;l=null,t.next(I)}};e.subscribe((0,z.x)(t,I=>{r?.unsubscribe(),s=!0,l=I,r=(0,z.x)(t,m,f.Z),(0,D.Xf)(i(I)).subscribe(r)},()=>{m(),t.complete()},void 0,()=>{l=r=null}))})}(l=>(0,A.H)(l?s:0)))),(0,h.R)(this.destroy$)).subscribe(s=>{this.isLoading=s,this.cdr.markForCheck()}),this.nzConfigService.getConfigChangeEventForComponent(b).pipe((0,h.R)(this.destroy$)).subscribe(()=>this.cdr.markForCheck()),this.directionality.change?.pipe((0,h.R)(this.destroy$)).subscribe(s=>{this.dir=s,this.cdr.detectChanges()}),this.dir=this.directionality.value}ngOnChanges(t){const{nzSpinning:s,nzDelay:l}=t;s&&this.spinning$.next(this.nzSpinning),l&&this.delay$.next(this.nzDelay)}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}}return i.\u0275fac=function(t){return new(t||i)(o.Y36(c.jY),o.Y36(o.sBO),o.Y36(T.Is,8))},i.\u0275cmp=o.Xpm({type:i,selectors:[["nz-spin"]],hostVars:2,hostBindings:function(t,s){2&t&&o.ekj("ant-spin-nested-loading",!s.nzSimple)},inputs:{nzIndicator:"nzIndicator",nzSize:"nzSize",nzTip:"nzTip",nzDelay:"nzDelay",nzSimple:"nzSimple",nzSpinning:"nzSpinning"},exportAs:["nzSpin"],features:[o.TTD],ngContentSelectors:p,decls:4,vars:2,consts:[["defaultTemplate",""],[4,"ngIf"],["class","ant-spin-container",3,"ant-spin-blur",4,"ngIf"],[1,"ant-spin-dot","ant-spin-dot-spin"],[1,"ant-spin-dot-item"],[1,"ant-spin"],[3,"ngTemplateOutlet"],["class","ant-spin-text",4,"ngIf"],[1,"ant-spin-text"],[1,"ant-spin-container"]],template:function(t,s){1&t&&(o.F$t(),o.YNc(0,u,5,0,"ng-template",null,0,o.W1O),o.YNc(2,B,4,12,"div",1),o.YNc(3,F,2,2,"div",2)),2&t&&(o.xp6(2),o.Q6J("ngIf",s.isLoading),o.xp6(1),o.Q6J("ngIf",!s.nzSimple))},dependencies:[y.O5,y.tP],encapsulation:2}),(0,g.gn)([(0,c.oS)()],i.prototype,"nzIndicator",void 0),(0,g.gn)([(0,v.Rn)()],i.prototype,"nzDelay",void 0),(0,g.gn)([(0,v.yF)()],i.prototype,"nzSimple",void 0),(0,g.gn)([(0,v.yF)()],i.prototype,"nzSpinning",void 0),i})(),d=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=o.oAB({type:i}),i.\u0275inj=o.cJS({imports:[T.vT,y.ez,L.Q8]}),i})()}}]);